(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{107:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),o=a(8),i=a.n(o),c=(a(84),a(70)),l=a(155),s=a(150),u=a(12),m=a(114),p=a(115),d=a(140),f=a(141),g=a(142),h=a(143),b=a(146),v=a(145),E=a(156),w=a(153),x=r.a.createContext({authenticated:!1,user:{}}),y=a(36),O=a.n(y),j=(a(85),a(63),a(108),{apiKey:"AIzaSyCNrWqbvDNEp53wNfDtDMqfZbgStsJEM-E",authDomain:"paiweb.firebaseapp.com",databaseURL:"https://paiweb.firebaseio.com",projectId:"paiweb",storageBucket:"paiweb.appspot.com",messagingSenderId:"560094021764",appId:"1:560094021764:web:d9efaf85f4747eb1"}),D={apiKey:j.apiKey,authDomain:j.authDomain,databaseURL:j.databaseUrl,projectId:j.projectId,storageBucket:j.storageBucket,messagingSenderId:j.mesagingSenderId,appId:j.appId};O.a.initializeApp(D),O.a.firestore().enablePersistence().catch(function(e){"failed-precondition"===e.code||e.code});var S=O.a,C=O.a.firestore(),N=Object(p.a)({root:{},grow:{flexGrow:1},avatar:{margin:0,padding:0,height:"24px",width:"24px"}})(function(e){var t=e.classes,a=r.a.useState(null),o=Object(u.a)(a,2),i=o[0],c=o[1],l=Boolean(i),s=Object(n.useContext)(x);return r.a.createElement("div",{className:t.root},r.a.createElement(d.a,{position:"static"},r.a.createElement(f.a,null,r.a.createElement(g.a,{variant:"h6",color:"inherit",className:t.grow},"Pai"),r.a.createElement(h.a,{color:"inherit",onClick:function(e){s.authenticated&&c(e.currentTarget)}},s.authenticated?r.a.createElement(v.a,{alt:"Remy Sharp",src:s.user.photoURL,className:t.avatar}):r.a.createElement(b.a,null,"account_circle")),r.a.createElement(w.a,{id:"menu-appbar",anchorEl:i,anchorOrigin:{vertical:"top",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},open:l,onClose:function(){c(null)}},r.a.createElement(E.a,{onClick:function(){c(null),S.auth().signOut(),e.setAuthContext({})}},"Sign out")))))}),k=Object(p.a)(function(e){return{appBar:{top:"auto",bottom:0},toolbar:{alignItems:"center",justifyContent:"space-between"}}})(function(e){var t=e.classes;return r.a.createElement(d.a,{position:"sticky",color:"primary",className:t.appBar},r.a.createElement(f.a,{className:t.toolbar},r.a.createElement(h.a,{color:"inherit","aria-label":"Open drawer",onClick:e.toggleDrawer(!0)},r.a.createElement(b.a,null,"menu")),e.camera,r.a.createElement("div",null,r.a.createElement(h.a,{color:"inherit"},r.a.createElement(b.a,null,"more_vert")))))}),I=a(50),R=a.n(I),P=a(68),A=function(e){return 100-((new Date).getTime()/1e3-e.seconds)/86400*100},L=function(e,t){var a="images/"+t.uid+"/"+function(e){return Date.now()+e.name.substr(e.name.lastIndexOf("."))}(e);S.storage().ref(a).put(e,{cacheControl:"max-age=432001",contentType:e.type}).on("state_changed",function(e){var t=e.bytesTransferred/e.totalBytes*100;console.log("percentage",t)},function(e){},function(){console.log("DONE!"),z(a,t)})},z=function(e,t){C.collection("posts").add({uid:t.uid,userPhotoURL:t.photoURL,imgRef:e,text:"",timestamp:S.firestore.FieldValue.serverTimestamp()}).then(function(e){console.log("Document written with docRef: ",e)}).catch(function(e){console.error("Error adding document: ",e)})},B=Object(m.a)(function(e){return{imgDiv:{borderRadius:"4px",minHeight:"250px",maxHeight:"75vh",maxWidth:"450px",overflow:"hidden"},img:{borderRadius:"4px",boxShadow:"0px 1px 3px 0px rgba(0,0,0,0.2), 0px 1px 1px 0px rgba(0,0,0,0.14), 0px 2px 1px -1px rgba(0,0,0,0.12)"}}}),U=function(e){var t=Object(n.useState)(""),a=Object(u.a)(t,2),o=a[0],i=a[1];Object(n.useEffect)(function(){return l(e.imageRef)},[e.imageRef]);var c=B(),l=function(e){(function(e){if(e)return S.storage().ref(e).getDownloadURL().then(function(e){return e})})(e).then(function(e){return i(e)})};return r.a.createElement("div",{className:c.imgDiv},r.a.createElement(R.a,{styles:"image-orientation: from-image",width:"100%",height:"auto",src:o,alt:"image post",className:c.img}))},W=a(113),T=a(148),F=Object(W.a)(function(e){return{text:{color:"white"},progress:{marginLeft:"5px",color:e.palette.color.main,zIndex:2},innerProgress:{position:"relative",marginLeft:"-16px",color:e.palette.gray.main,zIndex:1}}}),V=function(e){var t=new Date,a=(t.getTime()-e.getTime())/1e3;return a<60?parseInt(a)+"s":a<3600?parseInt(a/60)+"m":a<=86400?parseInt(a/3600)+"h":a>86400?e.getDate()+" "+e.toDateString().match(/ [a-zA-Z]*/)[0].replace(" ","")+(e.getFullYear()===t.getFullYear()?"":" "+e.getFullYear()):void 0},_=function(e){var t=F(),a=e.timestamp;return r.a.createElement(n.Fragment,null,r.a.createElement(g.a,{variant:"caption",className:t.text},V(a.toDate())),r.a.createElement(T.a,{color:"primary",variant:"static",value:A(a),className:t.progress,size:16}),r.a.createElement(T.a,{color:"secondary",variant:"static",value:100,className:t.innerProgress,size:16}))},Y=Object(m.a)(function(e){return{root:{scrollSnapAlign:"start",padding:"0px",height:"82vh",width:"100%",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center"},avatar:{border:"2px solid #fafafa",marginLeft:"6px"},avatarTimeDiv:{display:"flex",marginBottom:"-21px"}}}),K=function(e){var t=Y();return r.a.createElement("div",{className:t.root},r.a.createElement("span",null,r.a.createElement("div",{className:t.avatarTimeDiv},r.a.createElement(v.a,{className:t.avatar,alt:"Post Avatar",src:e.post.userPhotoURL}),r.a.createElement(_,{timestamp:e.post.timestamp})),r.a.createElement(U,{imageRef:e.post.imgRef})))},q=Object(m.a)(function(e){return{root:{padding:"0px",height:"78vh",display:"flex",flexDirection:"column",justifyContent:"space-around",textAlign:"center",alignItems:"center"},"@keyframes arrowAnimation":{from:{transform:"translateY(0)"},to:{transform:"translateY(30px)"}},icon:{position:"relative",fontSize:"65px",animation:"$arrowAnimation 2s infinite alternate"}}}),H=function(){var e=q();return r.a.createElement("div",{className:e.root},r.a.createElement("div",null),r.a.createElement("span",null,r.a.createElement(g.a,{align:"center",variant:"h4",color:"textSecondary"},"Show friends what you are up to.",r.a.createElement("br",null)," Post a picture.")),r.a.createElement(b.a,{color:"disabled",className:e.icon,fontSize:"large"},"arrow_downward"))},J=Object(m.a)(function(e){return{feedWrapper:{display:"flex",flexDirection:"column",alignItems:"center",backgroundColor:e.palette.background.main},feedTopDiv:{scrollSnapAlign:"end"},feedEndDiv:{display:"flex",justifyContent:"center",alignItems:"center",height:"15vh",color:e.palette.gray.main}}}),G=function(e){var t=Object(n.useState)([]),a=Object(u.a)(t,2),o=a[0],i=a[1],c=Object(n.useState)(!1),l=Object(u.a)(c,2),s=l[0],m=l[1],p=Object(n.useState)(!0),d=Object(u.a)(p,2),f=d[0],g=d[1],h=J(),v=function(){e.gotLatestPost?(e.latestValidPost?(m(!0),C.collection("posts").where("timestamp",">",new Date(Date.now()-864e5)).orderBy("timestamp","desc").limit(15).get().then(function(e){var t=[];return e.forEach(function(e){t.push(e.data())}),t}).then(function(e){return i(e)})):m(!1),g(!1)):g(!0)};Object(n.useEffect)(function(){v()},[e.latestValidPost]);return r.a.createElement("div",{className:h.feedWrapper},r.a.createElement("div",{className:h.feedTopDiv}),e.imagePreviewUrl&&r.a.createElement(R.a,{styles:"image-orientation: from-image",width:"100%",height:"auto",src:e.imagePreviewUrl,alt:"preview"}),f?r.a.createElement("p",null,"loading.."):s?[o.map(function(e,t){return r.a.createElement(K,{key:"post"+t,post:e})}),r.a.createElement("div",{key:"alasd213",className:h.feedEndDiv},r.a.createElement(b.a,{fontSize:"small"},"panorama_fish_eye"))]:r.a.createElement(H,null))},M=a(152),Z=Object(m.a)({drawerList:{width:"250px"}}),$=function(e){var t=e.open,a=e.toggleDrawer,n=Z();return r.a.createElement(M.a,{open:t,onClose:a(!1),onOpen:a(!0)},r.a.createElement("div",{tabIndex:0,role:"button",onClick:a(!1),onKeyDown:a(!1)},r.a.createElement("div",{className:n.drawerList},"v.0.0.7")))},Q=a(149),X=a(154),ee=Object(p.a)(function(e){return{fabButton:{position:"absolute",zIndex:2,top:"-29px",left:0,right:0,margin:"0 auto"},progressWrapper:{backgroundColor:e.palette.gray.main,position:"absolute",zIndex:1,top:0,left:0,right:0,margin:"0 auto",width:"64px",height:"32px",borderBottomLeftRadius:"128px",borderBottomRightRadius:"128px"},fabProgress:{position:"absolute",zIndex:1,top:-34,left:"-1px",right:0,margin:"0 auto",color:e.palette.color.main},hide:{display:"none"}}})(function(e){var t=e.classes,a=Object(n.createRef)(),o=Object(n.useState)(0),i=Object(u.a)(o,2),c=i[0],l=i[1],s=r.a.useState(!1),m=Object(u.a)(s,2),p=m[0],d=m[1],f=Object(n.useContext)(x);Object(n.useEffect)(function(){e.latestValidPost?l(A(e.latestValidPost.timestamp)):l(0)},[e.latestValidPost]);function g(e,t){"clickaway"!==t&&d(!1)}return r.a.createElement("div",null,r.a.createElement("span",{className:t.hide},r.a.createElement("input",{type:"file",accept:"image/*",capture:!0,onChange:function(t){return e.handleFile(t)},ref:a})),r.a.createElement(Q.a,{color:"secondary","aria-label":"Add",className:t.fabButton,size:"large",onClick:function(){f.authenticated?a.current.click():d(!0)}},r.a.createElement(b.a,null,"photo_camera")),r.a.createElement("div",{className:t.progressWrapper},r.a.createElement(T.a,{size:66,variant:"static",value:c,className:t.fabProgress})),r.a.createElement(X.a,{anchorOrigin:{vertical:"bottom",horizontal:"left"},message:r.a.createElement("span",{id:"message-id"},"Login to post pictures"),open:p,autoHideDuration:1e4,onClose:g,action:r.a.createElement(h.a,{key:"close","aria-label":"Close",color:"inherit",className:t.close,onClick:g},r.a.createElement(b.a,null,"close"))}))}),te=a(69),ae=a.n(te),ne=function(e){var t=Object(n.useState)(!1),a=Object(u.a)(t,2),o=a[0],i=a[1],c={signInFlow:"popup",signInOptions:[S.auth.GoogleAuthProvider.PROVIDER_ID],callbacks:{signInSuccessWithAuthResult:function(){return!1}}};return Object(n.useEffect)(function(){var t=S.auth().onAuthStateChanged(function(t){e.setAuthContext({authenticated:!!t,user:t}),t||i(!0)});return function(){t()}},[]),r.a.createElement("div",null,o?r.a.createElement(ae.a,{uiConfig:c,firebaseAuth:S.auth()}):r.a.createElement("p",{style:{textAlign:"center"}},"loading"))},re=Object(m.a)(function(e){return{App:{height:"100vh",display:"flex",flexDirection:"column",justifyContent:"space-between",maxWidth:"800px",width:"100%"}}}),oe=function(e){var t=Object(n.useState)(!1),a=Object(u.a)(t,2),o=a[0],i=a[1],c=Object(n.useState)(""),l=Object(u.a)(c,2),s=l[0],m=l[1],p=Object(n.useState)({}),d=Object(u.a)(p,2),f=d[0],g=d[1],h=Object(n.useState)(),b=Object(u.a)(h,2),v=b[0],E=b[1],w=Object(n.useState)(!1),y=Object(u.a)(w,2),O=y[0],j=y[1],D=re(),S=function(e){g(e)},I=function(e){return function(){i(e)}},R=function(){var e;f.authenticated&&(e=f.user.uid,C.collection("posts").where("timestamp",">",new Date(864e5)).where("uid","==",e).orderBy("timestamp","desc").limit(1).get().then(function(e){var t;return e.forEach(function(e){t=e.data()}),t})).then(function(e){j(!0),E(e)})};Object(n.useEffect)(function(){return R()},[f.authenticated]);return r.a.createElement("div",{className:D.App},r.a.createElement(x.Provider,{value:f},r.a.createElement(N,{setAuthContext:S}),r.a.createElement($,{open:o,toggleDrawer:I}),f.authenticated?r.a.createElement(G,{imagePreviewUrl:s,latestValidPost:v,gotLatestPost:O}):r.a.createElement(ne,{setAuthContext:S}),r.a.createElement(k,{toggleDrawer:I,camera:r.a.createElement(ee,{handleFile:function(e){var t=e.target.files[0];!t&&f.authenticated||function(e,t){e&&new P.a(e,{quality:.5,width:512,success:function(e){t(e)},error:function(e){console.log(e.message)}})}(t,function(e){m(URL.createObjectURL(e)),L(e,f.user)})},latestValidPost:v})})))},ie=Object(c.a)({palette:{background:{main:"#000000"},primary:{main:"#000000"},secondary:{main:"#ffffff"},color:{main:"#FF2188"},gray:{main:"#666666"}},typography:{useNextVariants:!0}});var ce=function(e){return r.a.createElement(l.a,{theme:ie},r.a.createElement(s.a,null),r.a.createElement(oe,null))},le=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function se(e,t){navigator.serviceWorker.register(e).then(function(e){e.onupdatefound=function(){var a=e.installing;null!=a&&(a.onstatechange=function(){"installed"===a.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}}).catch(function(e){console.error("Error during service worker registration:",e)})}i.a.render(r.a.createElement(ce,null),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("/paiweb",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",function(){var t="".concat("/paiweb","/service-worker.js");le?(function(e,t){fetch(e).then(function(a){var n=a.headers.get("content-type");404===a.status||null!=n&&-1===n.indexOf("javascript")?navigator.serviceWorker.ready.then(function(e){e.unregister().then(function(){window.location.reload()})}):se(e,t)}).catch(function(){console.log("No internet connection found. App is running in offline mode.")})}(t,e),navigator.serviceWorker.ready.then(function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://bit.ly/CRA-PWA")})):se(t,e)})}}()},79:function(e,t,a){e.exports=a(107)},84:function(e,t,a){}},[[79,1,2]]]);
//# sourceMappingURL=main.cd4e4c4f.chunk.js.map